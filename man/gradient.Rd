% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_wienR_helpers.R
\name{gradient}
\alias{gradient}
\title{Compute Gradient of Negative Log Likelihood}
\usage{
gradient(
  par,
  rt,
  response,
  bound_index,
  drift_index,
  resid_index,
  sv_index = NULL,
  sw_index = NULL,
  st0_index = NULL,
  ...
)
}
\arguments{
\item{par}{Named numeric vector of parameters. Names should follow the format
\code{a[i]}, \code{v[i]}, \code{w[i]}, \code{t0[i]}, \code{sv[i]}, \code{sw[i]}, \code{st0[i]} where i is the
parameter index.}

\item{rt}{Numeric vector of response times in seconds.}

\item{response}{Numeric vector of responses (typically 1 or 2, representing
lower or upper boundary).}

\item{bound_index}{Integer vector mapping each trial to its boundary separation
(a) and starting point (w) parameter index.}

\item{drift_index}{Integer vector mapping each trial to its drift rate (v)
parameter index.}

\item{resid_index}{Integer vector mapping each trial to its non-decision time
(t0) parameter index.}

\item{sv_index}{Integer vector mapping each trial to its drift rate variability
(sv) parameter index. Can be NULL if sv is not being estimated.}

\item{sw_index}{Integer vector mapping each trial to its starting point
variability (sw) parameter index. Can be NULL if sw is not being estimated.}

\item{st0_index}{Integer vector mapping each trial to its non-decision time
variability (st0) parameter index. Can be NULL if st0 is not being estimated.}

\item{...}{Additional arguments passed to \code{\link[WienR:WienerPDF]{WienR::WienerPDF()}}.}
}
\value{
A named numeric vector of gradients with the same length and names
as par. Returns a vector of NaN values if gradient evaluation fails.
}
\description{
Calculates the gradient (first derivative) of the negative log likelihood
with respect to each model parameter. Used for gradient-based optimization
in fit_wienr().
}
