% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_wienR_helpers.R
\name{gradient}
\alias{gradient}
\title{Gradient of Negative Log Likelihood}
\usage{
gradient(
  par,
  rt,
  response,
  bound_index,
  drift_index,
  resid_index,
  sv_index = NULL,
  sw_index = NULL,
  st0_index = NULL,
  ...
)
}
\arguments{
\item{par}{Named numeric vector of parameters in the format \code{param[i]} where
param is the parameter name (a, v, w, t0, sv, sw, st0) and i is the index.}

\item{rt}{Numeric vector of response times in seconds.}

\item{response}{Numeric vector of responses (typically 1 or 2, representing
lower or upper boundary).}

\item{bound_index}{Integer vector mapping each trial to its boundary
separation (a) and starting point (w) parameter index.}

\item{drift_index}{Integer vector mapping each trial to its drift rate (v)
parameter index.}

\item{resid_index}{Integer vector mapping each trial to its nondecision time
(t0) parameter index.}

\item{sv_index}{Integer vector mapping each trial to its drift rate
variability (sv) parameter index. Can be NULL if not estimated.}

\item{sw_index}{Integer vector mapping each trial to its starting point
variability (sw) parameter index. Can be NULL if not estimated.}

\item{st0_index}{Integer vector mapping each trial to its nondecision time
variability (st0) parameter index. Can be NULL if not estimated.}

\item{...}{Additional arguments passed to \code{\link[WienR:WienerPDF]{WienR::WienerPDF()}}.}
}
\value{
Named numeric vector of gradients with the same length and names as
\code{par}. Returns vector of \code{NaN} values if gradient evaluation fails.
}
\description{
Computes the gradient (first derivatives) of the negative log likelihood
with respect to each diffusion model parameter. Enables gradient-based
optimization methods for improved parameter estimation efficiency.
}
\references{
Ratcliff, R., & Tuerlinckx, F. (2002). Estimating parameters of the diffusion
model: Approaches to dealing with contaminant reaction times and parameter
variability. \emph{Psychonomic Bulletin & Review, 9}(3), 438-481.
}
