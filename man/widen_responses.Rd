% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/widen_responses.R
\name{widen_responses}
\alias{widen_responses}
\title{Parse and Reshape JSON-Style Survey Responses to Wide Format}
\usage{
widen_responses(DT, id_col = "sona_id")
}
\arguments{
\item{DT}{A data frame or data.table containing survey response data. Must
include a column with subject identifiers and a column named "response"
containing JSON-style strings with question-answer pairs in the format:
\code{'{"question1":"answer1","question2":"answer2"}'}.}

\item{id_col}{Character string specifying the name of the column containing
subject identifiers. Default is "sona_id".}
}
\value{
A data.table in wide format with one row per unique subject. The
first column is the subject identifier, followed by one column for each
unique question key found in the responses. If a subject has the same
question answered multiple times (e.g., across different rows), duplicate
keys are renamed with numeric suffixes (question_2, question_3, etc.).
Missing responses are filled with NA.
}
\description{
Extracts key-value pairs from JSON-style response strings and reshapes them
into wide format with one row per subject. When a subject has multiple
response rows, all responses are combined into a single row. Duplicate
question keys are handled by appending numeric suffixes (_2, _3, etc.).
}
\examples{
# Create sample survey data with JSON-style responses
survey_data <- data.table::data.table(
  sona_id = c(101, 101, 102, 103),
  response = c(
    '{"musicalIdentity":"No","musicalExperience":"I do not sing"}',
    '{"audioExperience":"5","normalHearing":"Yes"}',
    '{"musicalIdentity":"Yes","musicalExperience":"I play piano"}',
    '{"musicalIdentity":"No","hearingAbility":"Excellent"}'
  )
)

# Parse responses to wide format
result <- widen_responses(survey_data, id_col = "sona_id")

# With custom ID column name
survey_data2 <- data.table::data.table(
  participant_id = c(1, 2),
  response = c(
    '{"question1":"answer1","question2":"answer2"}',
    '{"question1":"answer3","question3":"answer4"}'
  )
)
result2 <- widen_responses(survey_data2, id_col = "participant_id")
}
